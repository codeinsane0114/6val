import{r as G}from"./validators-DpYrMFzk.js";import{w as Z,r as x,a as Oe,o as D,f as _,e as g,b as c,m as u,b2 as W,t as B,v as L,d as N,a3 as I,aZ as X,al as U,c as C,y as P,b1 as Ke,be as Ue,bf as Re,b5 as Me,b3 as qe,b4 as He,bq as Ze,F as J,h as Q,q as We,di as ie,dj as j,x as Xe,bb as Je}from"./main-BpgBUGps.js";import{_ as he}from"./AppTextField-CidaaHzM.js";import{_ as Ye}from"./AppSelect-crBF-FCt.js";import{_ as je}from"./AppDateTimePicker-CAkHnYZf.js";import{_ as Ge}from"./AppDrawerHeaderSection-3Bs6Y9hY.js";import{u as Qe,S as et,P as tt,U as nt,E as at}from"./index-D2c9LgJT.js";import{T as ot}from"./index-CP92O-j7.js";import{P as rt}from"./vue3-perfect-scrollbar.esm-BBUBQ5qB.js";import{V as lt}from"./VDivider-CPy3CxIk.js";import{V as ee}from"./VForm-HbYQbjWg.js";import{V as ve}from"./VCardText-RhVa6W5U.js";import{V as it,a as K}from"./VRow-DcLldsAi.js";import{V as ye}from"./VChip-Gdsswa87.js";import{V as st}from"./VSelect-CvnWonW6.js";import{V as De}from"./VAvatar-B9R7oHU8.js";import{V as se}from"./VImg-MA4fhMLa.js";import{V as Ne}from"./VTooltip-Cuy6b6Ub.js";import{V as dt}from"./VFileInput-DLFE1sHG.js";import{V as ct}from"./VNavigationDrawer-BkJcA9O0.js";import{_ as ut}from"./AppTextarea-CSkT_cUL.js";import{_ as ft}from"./MoreBtn-Byuib6ik.js";import{_ as mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as pt}from"./VSpacer-BwkbVUnR.js";import{V as gt}from"./VMenu-D0wOrHxC.js";import{V as bt}from"./VList-Bu48BGuL.js";import{V as ht}from"./VCard-DPA8ST1d.js";import{V as vt}from"./VTextField-DNnTNwAs.js";import{u as yt}from"./useApi-DdK-gkOH.js";import{$ as z}from"./api-TCFOQXkB.js";import"./helpers-DK5QwNv0.js";import"./form-jV7EneQK.js";import"./VField-CsvBDBUR.js";import"./easing-CjukEv2V.js";import"./VInput-h-v4JtUG.js";import"./forwardRefs-C-GTDzx5.js";/* empty css              */import"./VSlideGroup-qhrbewnN.js";import"./dialog-transition-Dw95iG-S.js";import"./VOverlay-BSwVgU5G.js";import"./delay-CiIYTbkJ.js";import"./lazy-CKzIgbSD.js";import"./scopeId-D5DaYZNr.js";import"./VCheckboxBtn-KnKlC77n.js";import"./VSelectionControl-tBJoG7de.js";import"./VCounter-B6UOvRBl.js";import"./ssrBoot-Cao_hl35.js";/* empty css                   */import"./index-B3bPRkoL.js";function Dt(e,t){var n=!1;return function(...a){n||(e.call(null,...a),n=!0,setTimeout(function(){n=!1},t))}}function xe(e){return e.split(" ").filter(t=>t)}var we=typeof window<"u";function R(e,t,n=!1){if(!t)return;const a=xe(t);if(a.length&&!a.includes("longTouch"))for(const o of e){if(!Y(o)||!S.has(o)){o.classList.add(...a);continue}const l=[],r=S.get(o);if(r){for(const d of a)o.classList.contains(d)?o.classList.contains(d)&&n===!1&&l.push(d):o.classList.add(d);r.privateClasses=l,S.set(o,r)}}}function te(e,t){if(!t)return;const n=xe(t);if(n.length)for(const a of e){if(!Y(a)){a.classList.remove(...n);continue}const o=S.get(a);if(o)for(const l of n)o.privateClasses.includes(l)||a.classList.remove(l)}}function ke(e){let t=e.parentNode;for(;t!==null&&t.nodeType===1&&t instanceof HTMLElement;){const a=window.getComputedStyle(t).getPropertyValue("overflow");if(a==="scroll"||a==="auto")return t;t=t.parentNode}return document.documentElement}function Nt(e){if(!(e.e instanceof TouchEvent))return;const t=e.e.touches[0].clientX,n=e.e.touches[0].clientY;let a=document.elementFromPoint(t,n);if(!Y(a))return;let o,l=!0;for(;a&&l;){if(S.has(a)||E.has(a)){l=!1,o=E.has(a);break}a=a.parentNode}if(o){const r=E.get(a);return r?{parent:{el:a,data:r}}:void 0}else{const r=S.get(a);if(!r)return;const d=E.get(a.parentNode);return d?{node:{el:a,data:r},parent:{el:a.parentNode,data:d}}:void 0}}function Y(e){return e instanceof HTMLElement&&e.parentNode instanceof HTMLElement}function Te(e,t){const n=new AbortController;for(const a in t){const o=t[a];e.addEventListener(a,o,{signal:n.signal,passive:!1})}return n}function Ie(e,t,n=!1){const a=window.getComputedStyle(e),o=["position","z-index","top","left","x","pointer-events","y","transform-origin","filter","-webkit-text-fill-color"];for(const l of Array.from(a))n===!1&&l&&o.includes(l)||t.style.setProperty(l,a.getPropertyValue(l),a.getPropertyPriority(l));for(const l of Array.from(e.children)){if(!Y(l))continue;const r=t.children[Array.from(e.children).indexOf(l)];Ie(l,r,n)}}function M(e){return e instanceof DragEvent?{x:e.clientX,y:e.clientY}:{x:e.touches[0].clientX,y:e.touches[0].clientY}}Array();var me=[{transform:"translateY(100%)"},{transform:"translateY(0)"}],pe=[{transform:"translateY(-100%)"},{transform:"translateY(0)"}],re=[{transform:"translateX(100%)"},{transform:"translateX(0)"}],le=[{transform:"translateX(-100%)"},{transform:"translateX(0)"}];function Ve(e={}){return t=>{const n=E.get(t);if(n)return{setup(){n.config.remapFinished=()=>{},document.head.querySelector("[data-drag-and-drop]")},setupNodeRemap(a){if(!i)return;const o=e.duration||150;if(a.nodeData.value===i.draggedNode.data.value){switch(i.incomingDirection){case"below":$(a.node,me,o);break;case"above":$(a.node,pe,o);break;case"left":$(a.node,le,o);break;case"right":$(a.node,re,o);break}return}if(!i.affectedNodes.map(m=>m.data.value).includes(a.nodeData.value))return;const l=a.node.getBoundingClientRect(),r=i.affectedNodes.findIndex(m=>m.data.value===a.nodeData.value),s=i.draggedNode.data.index>=i.targetIndex;let f;if(s?f=i.affectedNodes[r+1]?i.affectedNodes[r+1]:i.affectedNodes[r-1]:f=i.affectedNodes[r-1]?i.affectedNodes[r-1]:i.affectedNodes[r+1],f){const m=Math.abs(l.x-f.el.getBoundingClientRect().x),w=Math.abs(l.y-f.el.getBoundingClientRect().y);m>w&&s?$(a.node,le,o):m>w&&!s&&$(a.node,re,o)}else switch(i.incomingDirection){case"below":$(a.node,pe,o);break;case"above":$(a.node,me,o);break;case"left":$(a.node,re,o);break;case"right":$(a.node,le,o);break}}}}}function $(e,t,n){i&&(i.preventEnter=!0,e.animate(t,{duration:n}),setTimeout(()=>{i&&(i.swappedNodeValue=void 0,i.remapJustFinished=!0,i.lastTargetValue=void 0,i.preventEnter=!1)},n))}var ge={up:[0,-1],down:[0,1],left:[-1,0],right:[1,0]},S=new WeakMap,E=new WeakMap,i=void 0;function xt(){i=void 0}function Ce(e){return i={ascendingDirection:!1,incomingDirection:void 0,enterCount:0,targetIndex:0,affectedNodes:[],lastValue:void 0,activeNode:void 0,lastTargetValue:void 0,remapJustFinished:!1,preventEnter:!1,clonedDraggedEls:[],swappedNodeValue:!1,originalZIndex:void 0,...e},i}function wt(e,t){return i={...e,...t},i}function Pe(e){const{x:t,y:n}=M(e.e);return{coordinates:{x:t,y:n},draggedNode:{el:e.targetData.node.el,data:e.targetData.node.data},draggedNodes:[{el:e.targetData.node.el,data:e.targetData.node.data}],initialIndex:e.targetData.node.data.index,initialParent:{el:e.targetData.parent.el,data:e.targetData.parent.data},lastParent:{el:e.targetData.parent.el,data:e.targetData.parent.data},scrollParent:ke(e.targetData.node.el)}}function kt(e,t){const n=_e(e),o=[...de(t.targetData.parent.el,t.targetData.parent.data).filter(l=>!n.includes(l))];o.splice(t.targetData.node.data.index,0,...n),e.lastTargetValue=t.targetData.node.data.value,ce(t.targetData.parent.el,t.targetData.parent.data,[...o])}function de(e,t){return[...t.getValues(e)]}function ce(e,t,n){t.setValues(n,e)}function _e(e){return[...e.draggedNodes.map(t=>t.data.value)]}function Tt({parent:e,getValues:t,setValues:n,config:a={}}){var l,r;if(!we)return;document.addEventListener("dragover",d=>{if(d.preventDefault(),i){i.remapJustFinished=!1,i.lastTargetValue=void 0;const{x:s,y:f}=M(d);i.coordinates.y=f,i.coordinates.x=s,ne()}}),It(e);const o={getValues:t,setValues:n,config:{handleDragstart:_t,handleDragoverNode:tn,handleDragoverParent:nn,handleEnd:Ae,handleTouchstart:Ut,handleTouchmove:Ht,handleTouchOverNode:St,handleTouchOverParent:an,performSort:kt,performTransfer:ze,root:document,setupNode:Ft,setupNodeRemap:Be,reapplyDragClasses:zt,tearDownNode:Ot,tearDownNodeRemap:Lt,remapFinished:Pt,scrollBehavior:{x:.8,y:.8},threshold:{horizontal:0,vertical:0},...a},enabledNodes:[],abortControllers:{}};Vt(e,o),(l=a.plugins)==null||l.forEach(d=>{var s,f;(f=(s=d(e))==null?void 0:s.tearDown)==null||f.call(s)}),(r=a.plugins)==null||r.forEach(d=>{var s,f;(f=(s=d(e))==null?void 0:s.setup)==null||f.call(s)}),ue(e,!0)}function It(e){const t=E.get(e);t&&t.abortControllers.mainParent&&t.abortControllers.mainParent.abort()}function Vt(e,t){new MutationObserver(Ct).observe(e,{childList:!0}),E.set(e,t),t.abortControllers.mainParent=Te(e,{dragover:sn(Dt(t.config.handleDragoverParent,10)),touchOverParent:t.config.handleTouchOverParent})}function Ct(e){const t=e[0].target;t instanceof HTMLElement&&ue(t)}function ue(e,t){const n=E.get(e);if(!n)return;const a=[],o=n.config;for(let d=0;d<e.children.length;d++){const s=e.children[d];if(!Y(s))continue;const f=S.get(s);(t||!f)&&o.tearDownNode({node:s,parent:e,nodeData:f,parentData:n}),!o.disabled&&(!o.draggable||o.draggable&&o.draggable(s))&&a.push(s)}if(a.length!==n.getValues(e).length&&!o.disabled){console.warn("The number of enabled nodes does not match the number of values.");return}const l=n.getValues(e),r=[];for(let d=0;d<a.length;d++){const s=a[d],f=S.get(s),m=Object.assign(f??{privateClasses:[],abortControllers:{}},{value:l[d],index:d});if(i&&m.value===i.draggedNode.data.value&&(i.draggedNode.data=m,i.draggedNode.el=s),i&&i.draggedNodes.map(k=>k.data.value).includes(m.value)){const k=i.draggedNodes.find(y=>y.data.value===m.value);k&&(k.el=s)}r.push({el:s,data:m});const w={node:s,parent:e,parentData:n,nodeData:m};(t||!f)&&o.setupNode(w),Be(w)}E.set(e,{...n,enabledNodes:r}),o.remapFinished(n)}function Pt(){i&&(i.preventEnter=!1,i.swappedNodeValue=void 0,i.remapJustFinished=!0)}function _t(e){e.e instanceof DragEvent&&$t({e:e.e,targetData:e.targetData})}function Et(e,t,n){R([e],t),setTimeout(()=>{te([e],t),R([e],n)})}function Bt(e){const t=Ce(Pe(e));return e.e.stopPropagation(),e.e.dataTransfer&&(e.e.dataTransfer.dropEffect="move",e.e.dataTransfer.effectAllowed="move",e.e.dataTransfer.setDragImage(e.targetData.node.el,e.e.offsetX,e.e.offsetY)),t}function Ee(e){if(!(e.e instanceof DragEvent)&&!(e.e instanceof TouchEvent))return!1;const t=e.targetData.parent.data.config;if(!t.dragHandle)return!0;const n=e.targetData.node.el.querySelectorAll(t.dragHandle);if(!n)return!1;const a=M(e.e),o=t.root.elementFromPoint(a.x,a.y);if(!o)return!1;for(const l of Array.from(n))if(o===l||l.contains(o))return!0;return!1}function At(e){if(!Ee(e))return;const t=Rt(e);Mt(e,t),qt(e,t)}function $t(e){if(!Ee(e)){e.e.preventDefault();return}const t=e.targetData.parent.data.config,n=Bt(e),a=e.targetData.node.el.style.zIndex;n.originalZIndex=a,e.targetData.node.el.style.zIndex="9999",Et(n.draggedNode.el,t.draggingClass,t.dropZoneClass)}function St(e){i&&(e.detail.targetData.parent.el===i.lastParent.el?Fe(e.detail,i):ae(e.detail,i))}function Ft(e){var n;const t=e.parentData.config;e.node.draggable=!0,e.nodeData.abortControllers.mainNode=Te(e.node,{dragstart:q(t.handleDragstart),dragover:q(t.handleDragoverNode),dragend:q(t.handleEnd),touchstart:q(t.handleTouchstart),touchmove:q(t.handleTouchmove),touchend:q(t.handleEnd),touchOverNode:t.handleTouchOverNode}),t.reapplyDragClasses(e.node,e.parentData),(n=e.parentData.config.plugins)==null||n.forEach(a=>{var o,l;(l=(o=a(e.parent))==null?void 0:o.setupNode)==null||l.call(o,e)})}function Be(e){var t;S.set(e.node,e.nodeData),(t=e.parentData.config.plugins)==null||t.forEach(n=>{var a,o;(o=(a=n(e.parent))==null?void 0:a.setupNodeRemap)==null||o.call(a,e)})}function zt(e,t){if(!i)return;const n="touchedNode"in i?t.config.touchDropZoneClass:t.config.dropZoneClass;i.draggedNode.el===e&&R([e],n,!0)}function Lt(e){var t;(t=e.parentData.config.plugins)==null||t.forEach(n=>{var a,o;(o=(a=n(e.parent))==null?void 0:a.tearDownNodeRemap)==null||o.call(a,e)})}function Ot(e){var t,n,a,o,l;(t=e.parentData.config.plugins)==null||t.forEach(r=>{var d,s;(s=(d=r(e.parent))==null?void 0:d.tearDownNode)==null||s.call(d,e)}),e.node.draggable=!1,(a=(n=e.nodeData)==null?void 0:n.abortControllers)!=null&&a.mainNode&&((l=(o=e.nodeData)==null?void 0:o.abortControllers)==null||l.mainNode.abort())}function Ae(e){i&&(Kt(e,i),xt())}function Kt(e,t){var l,r,d,s;document.removeEventListener("contextmenu",$e),"longTouchTimeout"in t&&t.longTouchTimeout&&clearTimeout(t.longTouchTimeout);const n=(l=E.get(t.initialParent.el))==null?void 0:l.config,o="touchedNode"in t?n==null?void 0:n.touchDropZoneClass:n==null?void 0:n.dropZoneClass;t.originalZIndex!==void 0&&(t.draggedNode.el.style.zIndex=t.originalZIndex),R(t.draggedNodes.map(f=>f.el),o,!0),te(t.draggedNodes.map(f=>f.el),o),n!=null&&n.longTouchClass&&te(t.draggedNodes.map(f=>f.el),(d=(r=t.initialParent.data)==null?void 0:r.config)==null?void 0:d.longTouchClass),"touchedNode"in t&&((s=t.touchedNode)==null||s.remove())}function Ut(e){e.e instanceof TouchEvent&&At({e:e.e,targetData:e.targetData})}function Rt(e){e.e.stopPropagation();const t=e.targetData.node.el.cloneNode(!0),n=e.targetData.node.el.getBoundingClientRect();return wt(Ce(Pe(e)),{coordinates:{x:e.e.touches[0].clientX,y:e.e.touches[0].clientY},scrollParent:ke(e.targetData.node.el),touchStartLeft:e.e.touches[0].clientX-n.left,touchStartTop:e.e.touches[0].clientY-n.top,touchedNode:t,touchMoving:!1})}function $e(e){e.preventDefault()}function Mt(e,t){t.touchedNodeDisplay=t.touchedNode.style.display;const n=e.targetData.node.el.getBoundingClientRect();t.touchedNode.style.cssText=`
            width: ${n.width}px;
            position: fixed;
            pointer-events: none;
            top: -9999px;
            z-index: 999999;
            display: none;
          `,document.body.append(t.touchedNode),Ie(e.targetData.node.el,t.touchedNode),t.touchedNode.style.display="none",document.addEventListener("contextmenu",$e)}function qt(e,t){const n=e.targetData.parent.data.config;n.longTouch&&(t.longTouchTimeout=setTimeout(()=>{t&&(t.longTouch=!0,n.longTouchClass&&e.e.cancelable&&R(t.draggedNodes.map(a=>a.el),n.longTouchClass),e.e.preventDefault())},n.longTouchTimeout||200))}function Ht(e){!i||!("touchedNode"in i)||en(e,i)}function Zt(e,t){t.longTouchClass&&te(e.draggedNodes.map(n=>n.el),t==null?void 0:t.longTouchClass),t.touchDraggingClass&&R([e.touchedNode],t.touchDraggingClass),t.touchDropZoneClass&&R(e.draggedNodes.map(n=>n.el),t.touchDropZoneClass)}function Wt(e){if(!e||!e.scrollParent)return;const{x:t,y:n,width:a,height:o}=e.scrollParent.getBoundingClientRect(),{x:l,y:r,scrollOutside:d}=e.lastParent.data.config.scrollBehavior;return{state:e,xThresh:l,yThresh:r,scrollOutside:d,scrollParent:e.scrollParent,x:t,y:n,width:a,height:o}}function Xt(e){const t=Wt(i);if(t)switch(e){case"down":return Gt(t.state,t);case"up":return jt(t.state,t);case"right":return Jt(t.state,t);case"left":return Yt(t.state,t)}}function Jt(e,t){const n=t.scrollParent.clientWidth+t.x-e.coordinates.x;if(!(!t.scrollOutside&&n<0)&&n<(1-t.xThresh)*t.scrollParent.clientWidth&&!(t.scrollParent.scrollLeft+t.scrollParent.clientWidth>=t.scrollParent.scrollWidth))return e}function Yt(e,t){const n=t.scrollParent.clientWidth+t.x-e.coordinates.x;if(!(!t.scrollOutside&&n>t.scrollParent.clientWidth)&&n>t.xThresh*t.scrollParent.clientWidth&&t.scrollParent.scrollLeft!==0)return e}function jt(e,t){const n=t.scrollParent.clientHeight+t.y-e.coordinates.y;if(!(!t.scrollOutside&&n>t.scrollParent.clientHeight)&&n>t.yThresh*t.scrollParent.clientHeight&&t.scrollParent.scrollTop!==0)return e}function Gt(e,t){const n=t.scrollParent.clientHeight+t.y-e.coordinates.y;if(!(!t.scrollOutside&&n<0)&&n<(1-t.yThresh)*t.scrollParent.clientHeight&&!(t.scrollParent.scrollTop+t.scrollParent.clientHeight>=t.scrollParent.scrollHeight))return e}function Qt(e,t){t.touchMoving=!0,t.touchedNode.style.display=t.touchedNodeDisplay||"";const{x:n,y:a}=M(e.e);t.coordinates.y=a,t.coordinates.x=n;const o=t.touchStartLeft??0,l=t.touchStartTop??0;t.touchedNode.style.left=`${n-o}px`,t.touchedNode.style.top=`${a-l}px`,Zt(t,e.targetData.parent.data.config)}function en(e,t){if(e.targetData.parent.data.config.longTouch&&!t.longTouch){clearTimeout(t.longTouchTimeout);return}e.e.cancelable&&e.e.preventDefault(),Qt(e,t),ne();const a=Nt(e);if(!a)return;const o={e:e.e,targetData:a};"node"in a?a.node.el.dispatchEvent(new CustomEvent("touchOverNode",{detail:o})):a.parent.el.dispatchEvent(new CustomEvent("touchOverParent",{detail:o}))}function ne(){for(const e of Object.keys(ge)){const[t,n]=ge[e];Se(e,t,n)}}function Se(e,t,n){const a=Xt(e);a&&(a.scrollParent.scrollBy(t,n),setTimeout(()=>{Se(e,t,n)},"touchedNode"in a?10:100))}function tn(e){if(!i)return;const{x:t,y:n}=M(e.e);i.coordinates.y=n,i.coordinates.x=t,ne(),rn(e,i)}function nn(e){if(!i)return;const{x:t,y:n}=M(e.e);i.coordinates.y=n,i.coordinates.x=t,ne(),ae(e,i)}function an(e){i&&ae(e.detail,i)}function on(e,t){if(e.targetData.parent.el===t.lastParent.el)return!1;const n=e.targetData.parent.data.config;if(n.dropZone===!1)return!1;const a=t.initialParent.data.config;return n.accepts?n.accepts(e.targetData.parent,t.initialParent,t.lastParent,t):!(!n.group||n.group!==a.group)}function rn(e,t){var n;e.e.preventDefault(),e.e.stopPropagation(),e.targetData.parent.el===((n=t.lastParent)==null?void 0:n.el)?Fe(e,t):ae(e,t)}function ln(e,t,n,a){var w;if(t.remapJustFinished)return t.remapJustFinished=!1,t.lastTargetValue=e.targetData.node.data.value,!1;if(t.lastTargetValue===e.targetData.node.data.value||t.draggedNodes.map(k=>k.el).includes(e.targetData.node.el)||t.preventEnter||t.swappedNodeValue===e.targetData.node.data.value||e.targetData.parent.el!==((w=t.lastParent)==null?void 0:w.el)||e.targetData.parent.data.config.sortable===!1)return!1;const o=e.targetData.node.el.getBoundingClientRect(),l=t.draggedNode.el.getBoundingClientRect(),r=o.y-l.y,d=o.x-l.x;let s;const f=t.draggedNode.data.index>e.targetData.node.data.index?[e.targetData.node.data.index,t.draggedNode.data.index]:[t.draggedNode.data.index,e.targetData.node.data.index];t.targetIndex=e.targetData.node.data.index,t.affectedNodes=e.targetData.parent.data.enabledNodes.filter(k=>f[0]<=k.data.index&&k.data.index<=f[1]&&k.el!==t.draggedNode.el),Math.abs(r)>Math.abs(d)?s=r>0?"above":"below":s=d>0?"left":"right";const m=t.lastParent.data.config.threshold;switch(s){case"left":if(n>o.x+o.width*m.horizontal)return t.incomingDirection="left",!0;break;case"right":if(n<o.x+o.width*(1-m.horizontal))return t.incomingDirection="right",!0;break;case"above":if(a>o.y+o.height*m.vertical)return t.incomingDirection="above",!0;break;case"below":if(a<o.y+o.height*(1-m.vertical))return t.incomingDirection="below",!0;break}return!1}function Fe(e,t){const{x:n,y:a}=M(e.e);ln(e,t,n,a)&&(t.swappedNodeValue=e.targetData.node.data.value,t.preventEnter=!0,e.targetData.parent.data.config.performSort(t,e))}function q(e){function t(n){var r;const a=S.get(n),o=n.parentNode||((r=i==null?void 0:i.lastParent)==null?void 0:r.el);if(!a)return;const l=E.get(o);if(l)return{node:{el:n,data:a},parent:{el:o,data:l}}}return n=>{const a=t(n.currentTarget);if(a)return e({e:n,targetData:a})}}function ze(e,t){const n=_e(e),a=de(e.lastParent.el,e.lastParent.data).filter(d=>!n.includes(d)),o=de(t.targetData.parent.el,t.targetData.parent.data),l=e.initialParent.el===t.targetData.parent.el&&t.targetData.parent.data.config.sortable===!1;let r;"node"in t.targetData?(l?r=e.initialIndex:t.targetData.parent.data.config.sortable===!1?r=t.targetData.parent.data.enabledNodes.length:r=t.targetData.node.data.index,o.splice(r,0,...n)):(r=l?e.initialIndex:t.targetData.parent.data.enabledNodes.length,o.splice(r,0,...n)),ce(e.lastParent.el,e.lastParent.data,a),ce(t.targetData.parent.el,t.targetData.parent.data,o)}function ae(e,t){on(e,t)&&(e.targetData.parent.data.config.performTransfer(t,e),t.lastParent=e.targetData.parent)}function sn(e){function t(n){const a=E.get(n);if(a)return{parent:{el:n,data:a}}}return n=>{const a=t(n.currentTarget);if(a)return e({e:n,targetData:a})}}function be(e){if(e instanceof HTMLElement)return e;if(e.value instanceof HTMLElement)return e.value;if("$el"in e&&e.$el instanceof HTMLElement)return e.$el}function dn(e,t){Array.isArray(e)||(e=[e]);for(const n of e){const a=be(n);if(a)return t(a);const o=Z(n,l=>{if(!l)return;const r=be(l);r?t(r):console.warn("Invalid parent element",l),o()})}}var fe=new WeakMap;function cn(e){const t=fe.get(e);return t?t.value:(console.warn("No values found for parent element"),[])}function un(e,t){const n=fe.get(t);n&&(n.value=e)}function Le(e){we&&(Array.isArray(e)||(e=[e]),e.forEach(t=>{const{parent:n,values:a,...o}=t;dn(n,fn(o,a))}))}function fn(e,t){return n=>{fe.set(n,t),Tt({parent:n,getValues:cn,setValues:un,config:{...e,dropZones:[]}})}}const mn=N("p",{class:"mb-1 text-body-2 text-high-emphasis",style:{"line-height":"15px"}}," Assigned ",-1),pn=N("p",{class:"text-body-2 text-high-emphasis mb-1",style:{"line-height":"15px"}}," COMMENT ",-1),gn={class:"border rounded px-3 py-2"},bn={key:0,class:"d-flex justify-end flex-wrap gap-x-2"},hn={__name:"KanbanBoardEditDrawer",props:{kanbanItem:{type:null,required:!1,default:()=>({item:{title:"",dueDate:"2022-01-01T00:00:00Z",labels:[],members:[],id:0,attachments:0,commentsCount:0,image:"",comments:""},boardId:0,boardName:""})},isDrawerOpen:{type:Boolean,required:!0}},emits:["update:isDrawerOpen","update:kanbanItem","deleteKanbanItem"],setup(e,{emit:t}){const n=e,a=t,o=x(),l=["UX","Image","Code Review","Dashboard","Bug"],r=x(JSON.parse(JSON.stringify(n.kanbanItem.item))),d=V=>{var h;a("update:isDrawerOpen",V),V||(h=o.value)==null||h.reset()};Z(()=>n.kanbanItem,()=>{r.value=JSON.parse(JSON.stringify(n.kanbanItem.item))},{deep:!0});const s=()=>{var V;(V=o.value)==null||V.validate().then(async h=>{var A;h.valid&&(a("update:kanbanItem",{item:r.value,boardId:n.kanbanItem.boardId,boardName:n.kanbanItem.boardName}),a("update:isDrawerOpen",!1),await Ke(),(A=o.value)==null||A.reset())})},f=()=>{a("deleteKanbanItem",{item:r.value,boardId:n.kanbanItem.boardId,boardName:n.kanbanItem.boardName}),a("update:isDrawerOpen",!1)},m=Qe({content:"",extensions:[et,ot.configure({types:["heading","paragraph"]}),tt.configure({placeholder:"Write a Comment..."}),nt]}),w=x({altFormat:"M j, Y",altInput:!0,dateFormat:"Y-m-d"}),k={UX:"success",Image:"warning","Code Review":"info",Dashboard:"primary",Bug:"error"},y=[{img:Ue,name:"John Doe"},{img:Re,name:"Jane Smith"},{img:Me,name:"Robert Johnson"},{img:qe,name:"Lucy Brown"},{img:He,name:"Mike White"},{img:Ze,name:"Anna Black"}],F=x();return(V,h)=>{const A=Ge,O=he,H=je,v=Ye,p=Oe("IconBtn");return D(),_(ct,{location:"end",width:370,temporary:"",border:"0","model-value":n.isDrawerOpen,class:"kanban-navigation-drawer","onUpdate:modelValue":d},{default:g(()=>[c(A,{title:"Edit Task",onCancel:h[0]||(h[0]=b=>V.$emit("update:isDrawerOpen",!1))}),c(lt),c(u(rt),{options:{wheelPropagation:!1},style:{"block-size":"calc(100vh - 4rem)"}},{default:g(()=>[u(r)?(D(),_(u(ee),{key:0,ref_key:"refEditTaskForm",ref:o,onSubmit:W(s,["prevent"])},{default:g(()=>[c(ve,null,{default:g(()=>[c(it,null,{default:g(()=>[c(K,{cols:"12"},{default:g(()=>[c(O,{modelValue:u(r).title,"onUpdate:modelValue":h[1]||(h[1]=b=>u(r).title=b),label:"Title",rules:["requiredValidator"in V?V.requiredValidator:u(G)]},null,8,["modelValue","rules"])]),_:1}),c(K,{cols:"12"},{default:g(()=>[c(H,{modelValue:u(r).dueDate,"onUpdate:modelValue":h[2]||(h[2]=b=>u(r).dueDate=b),label:"Due date",config:u(w)},null,8,["modelValue","config"])]),_:1}),c(K,{cols:"12"},{default:g(()=>[c(v,{modelValue:u(r).labels,"onUpdate:modelValue":h[3]||(h[3]=b=>u(r).labels=b),items:l,label:"Label",multiple:"",eager:""},{chip:g(({item:b})=>[c(ye,{color:k[b.raw],closable:""},{default:g(()=>[B(L(b.raw),1)]),_:2},1032,["color"])]),_:1},8,["modelValue"])]),_:1}),c(K,{cols:"12"},{default:g(()=>[mn,N("div",null,[c(st,{modelValue:u(r).members,"onUpdate:modelValue":h[4]||(h[4]=b=>u(r).members=b),items:y,"item-title":"name","item-value":"name",multiple:"","return-object":"",variant:"plain","menu-props":{offset:10}},{selection:g(({item:b})=>[c(De,{size:"26"},{default:g(()=>[c(se,{src:b.raw.img},null,8,["src"]),c(Ne,{activator:"parent"},{default:g(()=>[B(L(b.raw.name),1)]),_:2},1024)]),_:2},1024)]),"prepend-inner":g(()=>[c(p,{size:"26",variant:"tonal"},{default:g(()=>[c(I,{size:"20",icon:"bx-plus"})]),_:1})]),_:1},8,["modelValue"])])]),_:1}),c(K,{cols:"12"},{default:g(()=>[c(dt,{modelValue:u(F),"onUpdate:modelValue":h[5]||(h[5]=b=>X(F)?F.value=b:null),"prepend-inner-icon":"",multiple:"",variant:"outlined",label:"No file chosen",clearable:""},{append:g(()=>[c(U,{variant:"tonal"},{default:g(()=>[B(" Choose ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),c(K,{cols:"12"},{default:g(()=>[pn,N("div",gn,[c(u(at),{editor:u(m)},null,8,["editor"]),u(m)?(D(),C("div",bn,[c(I,{icon:"bx-bold",color:u(m).isActive("bold")?"primary":"secondary",size:"20",onClick:h[6]||(h[6]=b=>u(m).chain().focus().toggleBold().run())},null,8,["color"]),c(I,{color:u(m).isActive("underline")?"primary":"secondary",icon:"bx-underline",size:"20",onClick:h[7]||(h[7]=b=>u(m).commands.toggleUnderline())},null,8,["color"]),c(I,{color:u(m).isActive("italic")?"primary":"secondary",icon:"bx-italic",size:"20",onClick:h[8]||(h[8]=b=>u(m).chain().focus().toggleItalic().run())},null,8,["color"]),c(I,{color:u(m).isActive({textAlign:"left"})?"primary":"secondary",icon:"bx-align-left",size:"20",onClick:h[9]||(h[9]=b=>u(m).chain().focus().setTextAlign("left").run())},null,8,["color"]),c(I,{color:u(m).isActive({textAlign:"center"})?"primary":"secondary",icon:"bx-align-middle",size:"20",onClick:h[10]||(h[10]=b=>u(m).chain().focus().setTextAlign("center").run())},null,8,["color"]),c(I,{color:u(m).isActive({textAlign:"right"})?"primary":"secondary",icon:"bx-align-right",size:"20",onClick:h[11]||(h[11]=b=>u(m).chain().focus().setTextAlign("right").run())},null,8,["color"])])):P("",!0)])]),_:1}),c(K,{cols:"12"},{default:g(()=>[c(U,{type:"submit",class:"me-4"},{default:g(()=>[B(" Update ")]),_:1}),c(U,{color:"error",variant:"tonal",onClick:f},{default:g(()=>[B(" Delete ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)):P("",!0)]),_:1})]),_:1},8,["model-value"])}}},vn={class:"d-flex align-start gap-2"},yn={key:0,class:"d-flex flex-wrap gap-2"},Dn={class:"text-base text-high-emphasis mb-0"},Nn={class:"task-footer d-flex align-center flex-wrap justify-space-between"},xn={key:0,class:"d-flex align-center gap-4"},wn={key:0},kn={class:"text-body-1 d-inline-block"},Tn={key:1},In={class:"text-body-1 d-inline-block"},Vn={key:1,class:"v-avatar-group"},Cn={__name:"KanbanCard",props:{item:{type:null,required:!0},boardId:{type:Number,required:!0},boardName:{type:String,required:!0}},emits:["deleteKanbanItem"],setup(e,{emit:t}){const n=e,a=t,o={UX:"success",Image:"warning","Code Review":"info",Dashboard:"primary",Bug:"error"},l=[{title:"Copy Task link",href:"#"},{title:"Duplicate Task",href:"#"},{title:"Delete",onClick:()=>{a("deleteKanbanItem",{item:n.item,boardId:n.boardId,boardName:n.boardName})}}];return(r,d)=>e.item?(D(),_(ht,{key:0,ripple:!1,link:!1,class:"kanban-card position-relative"},{default:g(()=>[c(ve,{class:"d-flex flex-column gap-2"},{default:g(()=>[N("div",vn,[e.item.labels&&e.item.labels.length?(D(),C("div",yn,[(D(!0),C(J,null,Q(e.item.labels,s=>(D(),_(ye,{key:s,size:"small",color:o[s]},{default:g(()=>[B(L(s),1)]),_:2},1032,["color"]))),128))])):P("",!0),c(pt),c(gt,null,{activator:g(({props:s,isActive:f})=>[c(I,We(s,{icon:"bx-dots-vertical-rounded",class:"position-absolute more-options",style:[{"inset-block-start":"16px","inset-inline-end":"10px"},f?"opacity: 1":""],size:"20",onClick:d[0]||(d[0]=W(()=>{},["stop"]))}),null,16,["style"])]),default:g(()=>[c(bt,{items:l,"item-props":""})]),_:1})]),e.item.image&&e.item.image.length?(D(),_(se,{key:0,src:e.item.image,class:"rounded"},null,8,["src"])):P("",!0),N("p",Dn,L(e.item.title),1),N("div",Nn,[e.item.attachments||e.item.commentsCount?(D(),C("div",xn,[e.item.attachments?(D(),C("div",wn,[c(I,{size:"20",icon:"bx-paperclip",class:"me-1"}),N("span",kn,L(e.item.attachments),1)])):P("",!0),e.item.commentsCount?(D(),C("div",Tn,[c(I,{size:"20",icon:"bx-chat",class:"me-1"}),N("span",In,L(e.item.commentsCount),1)])):P("",!0)])):P("",!0),e.item.members&&e.item.members.length?(D(),C("div",Vn,[(D(!0),C(J,null,Q(e.item.members,s=>(D(),_(De,{key:s.name,size:"30"},{default:g(()=>[c(se,{src:s.img},null,8,["src"]),c(Ne,{activator:"parent"},{default:g(()=>[B(L(s.name),1)]),_:2},1024)]),_:2},1024))),128))])):P("",!0)])]),_:1})]),_:1})):P("",!0)}},Pn=mt(Cn,[["__scopeId","data-v-7ddd1f19"]]),_n={class:"kanban-board"},En={class:"kanban-board-header pb-4"},Bn={key:1,class:"d-flex align-center justify-space-between"},An={class:"text-h5 text-truncate"},$n={class:"d-flex align-center"},Sn={class:"add-new-form"},Fn=N("span",null,"Add New Item",-1),zn={class:"mb-4"},Ln={class:"d-flex gap-4 flex-wrap"},On={__name:"KanbanItems",props:{kanbanIds:{type:Array,required:!0},groupName:{type:String,required:!0},boardName:{type:String,required:!0},boardId:{type:Number,required:!0},kanbanData:{type:null,required:!0}},emits:["renameBoard","deleteBoard","addNewItem","editItem","updateItemsState","deleteItem"],setup(e,{emit:t}){const n=e,a=t,o=x(),l=x(n.boardName),r=x(n.kanbanIds),d=x(!1),s=x(!1),f=x(),m=x(""),w=x(),k=[{title:"Rename",prependIcon:"bx-edit",onClick:()=>{s.value=!0}},{title:"Delete",prependIcon:"bx-trash",onClick:()=>a("deleteBoard",n.boardId)}],y=()=>{var v;(v=w.value)==null||v.validate().then(p=>{p.valid&&(a("renameBoard",{oldName:n.boardName,newName:l.value,boardId:n.boardId}),s.value=!1)})},F=()=>{var v;(v=f.value)==null||v.validate().then(p=>{p.valid&&(a("addNewItem",{itemTitle:m.value,boardName:n.boardName,boardId:n.boardId}),d.value=!1,m.value="")})};Le({parent:o,values:r,group:n.groupName,draggable:v=>v.classList.contains("kanban-card"),plugins:[Ve()],performTransfer:(v,p)=>{ze(v,p),a("updateItemsState",{boardId:n.boardId,ids:r.value})},handleEnd:v=>{Ae(v),a("updateItemsState",{boardId:n.boardId,ids:r.value})}}),Z(n,()=>{r.value=n.kanbanIds},{immediate:!0,deep:!0});const V=v=>n.kanbanData.items.find(p=>p.id===v),h=v=>{a("deleteItem",v)},A=()=>{var v;d.value=!1,(v=f.value)==null||v.reset()};ie(f,A),ie(w,()=>{s.value=!1});const O=()=>{s.value=!1,l.value=n.boardName},H=v=>{v.key==="Enter"&&!v.shiftKey&&F()};return(v,p)=>{const b=ft,oe=ut;return D(),C("div",_n,[N("div",En,[u(s)?(D(),_(u(ee),{key:0,ref_key:"refKanbanBoardTitle",ref:w,onSubmit:W(y,["prevent"])},{default:g(()=>[c(vt,{modelValue:u(l),"onUpdate:modelValue":p[0]||(p[0]=T=>X(l)?l.value=T:null),autofocus:"",variant:"underlined",rules:["requiredValidator"in v?v.requiredValidator:u(G)],"hide-details":"",class:"border-0",onKeydown:j(O,["esc"])},{"append-inner":g(()=>[c(I,{size:"20",color:"success",icon:"bx-check",class:"me-1",onClick:y}),c(I,{size:"20",variant:"text",color:"error",icon:"bx-x",class:"flip-in-rtl",onClick:O})]),_:1},8,["modelValue","rules"])]),_:1},512)):(D(),C("div",Bn,[N("h5",An,L(e.boardName),1),N("div",$n,[c(I,{class:"drag-handler",size:"20",icon:"bx-move"}),c(b,{size:"small","icon-size":"20","menu-list":k,"item-props":"",class:"text-high-emphasis"})])]))]),u(r)?(D(),C("div",{key:0,ref_key:"refKanbanBoard",ref:o,class:Xe(["kanban-board-drop-zone rounded d-flex flex-column gap-4",u(r).length?"mb-4":""])},[(D(!0),C(J,null,Q(u(r),T=>(D(),_(Pn,{key:T,item:V(T),"board-id":n.boardId,"board-name":n.boardName,onDeleteKanbanItem:h,onClick:Zn=>a("editItem",{item:V(T),boardId:n.boardId,boardName:n.boardName})},null,8,["item","board-id","board-name","onClick"]))),128)),N("div",Sn,[N("div",{class:"text-body-1 text-high-emphasis cursor-pointer d-flex align-center gap-1 ms-4",onClick:p[1]||(p[1]=T=>d.value=!u(d))},[c(I,{size:"15",icon:"bx-plus"}),Fn]),u(d)?(D(),_(u(ee),{key:0,ref_key:"refForm",ref:f,class:"mt-4","validate-on":"submit",onSubmit:W(F,["prevent"])},{default:g(()=>[N("div",zn,[c(oe,{modelValue:u(m),"onUpdate:modelValue":p[2]||(p[2]=T=>X(m)?m.value=T:null),rules:["requiredValidator"in v?v.requiredValidator:u(G)],placeholder:"Add Content",autofocus:"",rows:"2",onKeydown:[j(H,["enter"]),j(A,["esc"])]},null,8,["modelValue","rules"])]),N("div",Ln,[c(U,{size:"small",type:"submit"},{default:g(()=>[B(" Add ")]),_:1}),c(U,{size:"small",variant:"tonal",color:"secondary",onClick:A},{default:g(()=>[B(" Cancel ")]),_:1})])]),_:1},512)):P("",!0)])],2)):P("",!0)])}}},Kn={class:"kanban-main-wrapper d-flex gap-4 h-100"},Un={class:"add-new-form text-no-wrap",style:{"inline-size":"10rem"}},Rn=N("span",null,"Add New",-1),Mn={class:"mb-4"},qn={class:"d-flex gap-3"},Hn={__name:"KanbanBoard",props:{kanbanData:{type:null,required:!0},groupName:{type:String,required:!1,default:"kanban"}},emits:["addNewBoard","renameBoard","deleteBoard","addNewItem","editItem","deleteItem","updateItemsState","updateBoardState"],setup(e,{emit:t}){const n=e,a=t,o=x(),l=x(n.kanbanData.boards),r=x(!1),d=x(!1),s=x(),f=x(""),m=x(),w=()=>{var p;(p=s.value)==null||p.validate().then(b=>{b.valid&&(a("addNewBoard",f.value),d.value=!1,f.value="")})},k=p=>{a("deleteBoard",p)},y=p=>{a("renameBoard",p)},F=p=>{a("addNewItem",p)},V=p=>{p&&(m.value=p,r.value=!0)},h=p=>{a("updateItemsState",p)};Le({parent:o,values:l,dragHandle:".drag-handler",plugins:[Ve()]}),Z(n,()=>{l.value=n.kanbanData.boards,ue(o.value)},{deep:!0});const A=p=>{a("editItem",p)},O=p=>{a("deleteItem",p)};Z(l,()=>{const p=l.value.map(b=>b.id);a("updateBoardState",p)},{deep:!0});const H=()=>n.kanbanData.boards.some(p=>f.value&&p.title.toLowerCase()===f.value.toLowerCase())?"Board title already exists":!0,v=()=>{var p;d.value=!1,(p=s.value)==null||p.reset()};return ie(s,v),(p,b)=>{const oe=he;return D(),C(J,null,[N("div",Kn,[N("div",{ref_key:"kanbanWrapper",ref:o,class:"d-flex ga-6 pt-1"},[(D(!0),C(J,null,Q(u(l),T=>(D(),_(On,{key:T.id,"group-name":e.groupName,"kanban-ids":T.itemsIds,"board-name":T.title,"board-id":T.id,"kanban-items":e.kanbanData.items,"kanban-data":e.kanbanData,onDeleteBoard:k,onRenameBoard:y,onAddNewItem:F,onEditItem:V,onUpdateItemsState:h,onDeleteItem:O},null,8,["group-name","kanban-ids","board-name","board-id","kanban-items","kanban-data"]))),128))],512),N("div",Un,[N("h5",{class:"text-h5 cursor-pointer d-flex align-center gap-2",onClick:b[0]||(b[0]=T=>d.value=!u(d))},[c(I,{size:"18",icon:"bx-plus"}),Rn]),u(d)?(D(),_(u(ee),{key:0,ref_key:"refAddNewBoard",ref:s,class:"mt-4","validate-on":"submit",onSubmit:W(w,["prevent"])},{default:g(()=>[N("div",Mn,[c(oe,{modelValue:u(f),"onUpdate:modelValue":b[1]||(b[1]=T=>X(f)?f.value=T:null),rules:["requiredValidator"in p?p.requiredValidator:u(G),H],autofocus:"",placeholder:"Add Board Title",onKeydown:j(v,["esc"])},null,8,["modelValue","rules"])]),N("div",qn,[c(U,{size:"small",type:"submit"},{default:g(()=>[B(" Add ")]),_:1}),c(U,{size:"small",variant:"tonal",color:"secondary",type:"reset",onClick:v},{default:g(()=>[B(" Cancel ")]),_:1})])]),_:1},512)):P("",!0)])]),c(hn,{"is-drawer-open":u(r),"onUpdate:isDrawerOpen":b[2]||(b[2]=T=>X(r)?r.value=T:null),"kanban-item":u(m),"onUpdate:kanbanItem":A,onDeleteKanbanItem:O},null,8,["is-drawer-open","kanban-item"])],64)}}},Ra={__name:"index",async setup(e){let t,n;const{data:a,execute:o}=([t,n]=Je(()=>yt("/apps/kanban")),t=await t,n(),t),l=async y=>{await z("/apps/kanban/board/add",{method:"POST",body:{title:y}}),o()},r=async y=>{await z(`/apps/kanban/board/${y}`,{method:"DELETE"}),o()},d=async y=>{await z("/apps/kanban/board/rename",{method:"PUT",body:y}),o()},s=async y=>{await z("/apps/kanban/item/add",{method:"POST",body:y}),o()},f=async y=>{await z("/apps/kanban/item/update",{method:"PUT",body:y}),o()},m=async y=>{y.item&&y.item.id&&(await z(`/apps/kanban/item/${y.item.id}`,{method:"DELETE",body:y}),o())},w=async y=>{await z("/apps/kanban/item/state-update",{method:"PUT",body:y})},k=async y=>{await z("/apps/kanban/board/state-update",{method:"PUT",body:y})};return(y,F)=>u(a)?(D(),_(Hn,{key:0,"kanban-data":u(a),onAddNewBoard:l,onDeleteBoard:r,onRenameBoard:d,onAddNewItem:s,onEditItem:f,onDeleteItem:m,onUpdateItemsState:w,onUpdateBoardState:k},null,8,["kanban-data"])):P("",!0)}};export{Ra as default};
